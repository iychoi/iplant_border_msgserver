# iPlant Border Message Server Docker Image

Build Docker Image
------------------

Building a Docker image does not require you to build program source code. Prebuilt Release and Debug binaries are aleady included under "messageserver/" path.

Run config.py first to generate configurations that message server needs.
```
python config.py
```

Then, build docker image using Dockerfile.
```
sudo docker build -t iplant_msg_server .
```

The docker image created will export two network ports, 5672 and 15672. Port 5672 is a default RabbitMQ communication port and port 15672 is a RabbitMQ management port. You will need to bind them to host ports to access from host machine or from outside.

By default, the border message server program will start with a Debug binary. To change this to Release binary which is faster in execution, you need to change a symbolic link file "messageserver/iplant_border_msg_server".

By default, log messages generated by the border message server program will be printed out to a console. If you want to redirect them to a file or a network, you need to reconfigure log4cxx configuration file "messageserver/log4cxx.xml".

Launch Message Server
---------------------

Run docker.
```
sudo docker run --rm=true --name iplant_msg_svr -p 15672:15672 -p 5672:5672 iplant_msg_server
```

Port 15672 is a port for RabbitMQ management Web interface. You can access the management UI through "http://localhost:15672".
